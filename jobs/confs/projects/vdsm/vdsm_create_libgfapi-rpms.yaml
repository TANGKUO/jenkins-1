- project:
    name: vdsm_master-libgfapi_create-rpms
    project:
      - vdsm
    trigger:
      - merged
    version:
      - master-libgfapi:
          branch: master
    mock-build-type: all
    arch: x86_64
      # PPC64 is not available yet
      # - ppc64
    # Build usually require latest ioprocess rpms from testing repositories
    distro:
      - fc21:
          extra-repos: |
            ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
            ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
            updates-testing,http://proxy.phx.ovirt.org:5000/fedora-updates-testing/21/\\$basearch
            gluster-fc21,http://download.gluster.org/pub/gluster/glusterfs/LATEST/Fedora/fedora-21/\\$basearch
      - fc22:
          extra-repos: |
            ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
            ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
            updates-testing,http://proxy.phx.ovirt.org:5000/fedora-updates-testing/22/\\$basearch
            gluster-fc22,http://download.gluster.org/pub/gluster/glusterfs/LATEST/Fedora/fedora-22/\\$basearch
      - el7:
          extra-repos: |
            ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
            ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
            epel-testing,http://download.fedoraproject.org/pub/epel/testing/7/\\$basearch
            gluster-epel7,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-7/\\$basearch
    extra-build-packages: |
      autoreconf
      gettext-devel
      make
      automake
      pyflakes
      python-pep8
      libvirt-python
      python-devel
      python-nose
      sanlock-python
      python-ordereddict
      python-pthreading
      libselinux-python
      python-ethtool
      m2crypto
      python-dmidecode
      python-netaddr
      python-inotify
      python-argparse
      git
      python-cpopen
      bridge-utils
      libguestfs-tools-c
      pyparted
      openssl
      libnl
      libtool
      gettext-devel
      python-ioprocess
      python-six
    extra-packages: |
      pyflakes
      python-pep8
    extra-env: |
      NOSE_EXCLUDE=.*
    extra-rpmbuild-options: 'with_hooks=1'
    cherry-pick: |
      refs/changes/68/33768/3
    jobs:
      - '{project}_{version}_create-rpms-{distro}-{arch}_{trigger}'
