- project:
    name: vdsm_3.5_create-rpms
    project:
      - vdsm
    trigger:
      - merged
    version:
      - 3.5
    branch: ovirt-3.5
    mock-build-type: all
    distro:
      - fc21:
          extra-repos: |
            ovirt-3.5-snapshot,http://resources.ovirt.org/pub/ovirt-3.5-snapshot/rpm/$distro
            ovirt-3.5-snapshot-static,http://resources.ovirt.org/pub/ovirt-3.5-snapshot-static/rpm/$distro
            ci-tools,http://resources.ovirt.org/repos/ci-tools/$distro
      - el6:
          extra-repos: |
            ovirt-3.5-snapshot,http://resources.ovirt.org/pub/ovirt-3.5-snapshot/rpm/$distro
            ovirt-3.5-snapshot-static,http://resources.ovirt.org/pub/ovirt-3.5-snapshot-static/rpm/$distro
            ci-tools,http://resources.ovirt.org/repos/ci-tools/$distro
            gluster-epel6,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-6/\\$basearch
      - el7:
          extra-repos: |
            ovirt-3.5-snapshot,http://resources.ovirt.org/pub/ovirt-3.5-snapshot/rpm/$distro
            ovirt-3.5-snapshot-static,http://resources.ovirt.org/pub/ovirt-3.5-snapshot-static/rpm/$distro
            ci-tools,http://resources.ovirt.org/repos/ci-tools/$distro
            gluster-epel7,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-7/\\$basearch
    arch: x86_64
      # PPC64 is not available yet
      # - ppc64
    extra-build-packages: |
      autoreconf
      gettext-devel
      make
      automake
      pyflakes
      python-pep8
      libvirt-python
      python-devel
      python-nose
      sanlock-python
      python-ordereddict
      python-pthreading
      libselinux-python
      python-ethtool
      m2crypto
      python-dmidecode
      python-netaddr
      python-inotify
      python-argparse
      git
      python-cpopen
      bridge-utils
      libguestfs-tools-c
      pyparted
      openssl
      libnl
      libtool
      gettext-devel
      python-ioprocess
    extra-packages: |
      pyflakes
      python-pep8
    extra-env: |
      NOSE_EXCLUDE=.*
    extra-rpmbuild-options: 'with_hooks=1'
    extra-configure-options: |
      '--prefix=/usr'
      '--sysconfdir=/etc'
      '--localstatedir=/var'
      '--libdir=/usr/lib64'
    jobs:
      - '{project}_{version}_create-rpms-{distro}-{arch}_{trigger}'


- project:
    name: vdsm_3.6_create-rpms
    project:
      - vdsm
    trigger:
      - merged
    version:
      - 3.6:
          branch: ovirt-3.6
    mock-build-type: all
    arch: x86_64
      # PPC64 is not available yet
      # - ppc64
    # Build usually require latest ioprocess rpms from testing repositories
    # FC23 doesn't need gluster repo for now
    distro:
      - fc21:
          extra-repos: |
            ovirt-3.6-snapshot,http://resources.ovirt.org/pub/ovirt-3.6-snapshot/rpm/$distro
            ovirt-3.6-snapshot-static,http://resources.ovirt.org/pub/ovirt-3.6-snapshot-static/rpm/$distro
            updates-testing,http://proxy.phx.ovirt.org:5000/fedora-updates-testing/21/\\$basearch
            gluster-fc21,http://download.gluster.org/pub/gluster/glusterfs/LATEST/Fedora/fedora-21/\\$basearch
      - fc22:
          extra-repos: |
            ovirt-3.6-snapshot,http://resources.ovirt.org/pub/ovirt-3.6-snapshot/rpm/$distro
            ovirt-3.6-snapshot-static,http://resources.ovirt.org/pub/ovirt-3.6-snapshot-static/rpm/$distro
            updates-testing,http://proxy.phx.ovirt.org:5000/fedora-updates-testing/22/\\$basearch
            gluster-fc22,http://download.gluster.org/pub/gluster/glusterfs/LATEST/Fedora/fedora-22/\\$basearch
      - fc23:
          extra-repos: |
            ovirt-3.6-snapshot,http://resources.ovirt.org/pub/ovirt-3.6-snapshot/rpm/$distro
            ovirt-3.6-snapshot-static,http://resources.ovirt.org/pub/ovirt-3.6-snapshot-static/rpm/$distro
            updates-testing,http://proxy.phx.ovirt.org:5000/fedora-updates-testing/23/\\$basearch
      - el7:
          extra-repos: |
            ovirt-3.6-snapshot,http://resources.ovirt.org/pub/ovirt-3.6-snapshot/rpm/$distro
            ovirt-3.6-snapshot-static,http://resources.ovirt.org/pub/ovirt-3.6-snapshot-static/rpm/$distro
            epel-testing,http://download.fedoraproject.org/pub/epel/testing/7/\\$basearch
            gluster-epel7,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-7/\\$basearch
    extra-build-packages: |
      autoreconf
      gettext-devel
      make
      automake
      pyflakes
      python-pep8
      libvirt-python
      python-devel
      python-nose
      sanlock-python
      python-ordereddict
      python-pthreading
      libselinux-python
      python-ethtool
      m2crypto
      python-dmidecode
      python-netaddr
      python-inotify
      python-argparse
      git
      python-cpopen
      bridge-utils
      libguestfs-tools-c
      pyparted
      openssl
      libnl
      libtool
      gettext-devel
      python-ioprocess
      python-six
    extra-packages: |
      pyflakes
      python-pep8
    extra-env: |
      NOSE_EXCLUDE=.*
    extra-rpmbuild-options: 'with_hooks=1'
    extra-configure-options: |
      '--prefix=/usr'
      '--sysconfdir=/etc'
      '--localstatedir=/var'
      '--libdir=/usr/lib64'
    jobs:
      - '{project}_{version}_create-rpms-{distro}-{arch}_{trigger}'

- project:
    name: vdsm_master_create-rpms
    project:
      - vdsm
    trigger:
      - merged
    version:
      - master:
          branch: master
    mock-build-type: all
    arch: x86_64
      # PPC64 is not available yet
      # - ppc64
    # Build usually require latest ioprocess rpms from testing repositories
    distro:
      - fc21:
          extra-repos: |
            ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
            ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
            updates-testing,http://proxy.phx.ovirt.org:5000/fedora-updates-testing/21/\\$basearch
            gluster-fc21,http://download.gluster.org/pub/gluster/glusterfs/LATEST/Fedora/fedora-21/\\$basearch
      - fc22:
          extra-repos: |
            ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
            ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
            updates-testing,http://proxy.phx.ovirt.org:5000/fedora-updates-testing/22/\\$basearch
            gluster-fc22,http://download.gluster.org/pub/gluster/glusterfs/LATEST/Fedora/fedora-22/\\$basearch
      - el7:
          extra-repos: |
            ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
            ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
            epel-testing,http://download.fedoraproject.org/pub/epel/testing/7/\\$basearch
            gluster-epel7,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-7/\\$basearch
    extra-build-packages: |
      autoreconf
      gettext-devel
      make
      automake
      pyflakes
      python-pep8
      libvirt-python
      python-devel
      python-nose
      sanlock-python
      python-ordereddict
      python-pthreading
      libselinux-python
      python-ethtool
      m2crypto
      python-dmidecode
      python-netaddr
      python-inotify
      python-argparse
      git
      python-cpopen
      bridge-utils
      libguestfs-tools-c
      pyparted
      openssl
      libnl
      libtool
      gettext-devel
      python-ioprocess
      python-six
    extra-packages: |
      pyflakes
      python-pep8
    extra-env: |
      NOSE_EXCLUDE=.*
    extra-rpmbuild-options: 'with_hooks=1'
    extra-configure-options: |
      '--prefix=/usr'
      '--sysconfdir=/etc'
      '--localstatedir=/var'
      '--libdir=/usr/lib64'
    jobs:
      - '{project}_{version}_create-rpms-{distro}-{arch}_{trigger}'
