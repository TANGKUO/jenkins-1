- lago_common:
    name: lago_common
    lago_common--key: &lago_common
      project: lago
      version:
        - master:
            branch: master
      distro:
        - fc24
        - fc25
        - el7
      trigger: 'on-change'
      arch: x86_64
      reponame: lago
      org: lago-project

# TODO: migrate to pipeline when ready
- project:
    <<: *lago_common
    name: lago_check-patch_standard
    stage: 'check-patch'
    node-filter: '(nested) && {distro}'
    jobs:
      - '{project}_{version}_github_check-patch-{distro}-{arch}'

# This is already using the pipeline
- project:
    <<: *lago_common
    name: lago_checks_standard
    stage:
      - build-artifacts
      - check-merged:
          node-filter: 'integ-tests'
    jobs:
      - '{project}_{version}_github_{stage}-{distro}-{arch}'
      - '{project}_{version}_deploy-to-{reponame}-snapshot'

- project:
    <<: *lago_common
    name: lago_checks_standard_pipeline
    stage:
      - check-merged
    jobs:
      - '{project}_{version}_github_{stage}-trigger'
      - '{project}_{version}_github_{stage}-pipeline'
