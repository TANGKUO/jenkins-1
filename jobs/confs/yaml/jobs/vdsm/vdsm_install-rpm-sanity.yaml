- project:
    name: vdsm_install-rpm-sanity
    project: vdsm
    trigger: created
    version:
      - master:
          branch: master
    mock-build-type: onlyrpm
    distro:
      - fc20:
          extra-repos: |
              ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
              ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
              glusterfs-fedora-nightly,http://download.gluster.org/pub/gluster//glusterfs/nightly/glusterfs/fedora-\\$releasever-\\$basearch
              glusterfs-fedora,http://download.gluster.org/pub/gluster/glusterfs/LATEST/Fedora/fedora-\\$releasever/\\$basearch
              glusterfs-noarch-fedora,http://download.gluster.org/pub/gluster/glusterfs/LATEST/Fedora/fedora-\\$releasever/noarch
      - fc21:
          extra-repos: |
              ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
              ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
              glusterfs-fedora-nightly,http://download.gluster.org/pub/gluster//glusterfs/nightly/glusterfs/fedora-\\$releasever-\\$basearch
              glusterfs-fedora,http://download.gluster.org/pub/gluster/glusterfs/LATEST/Fedora/fedora-\\$releasever/\\$basearch
              glusterfs-noarch-fedora,http://download.gluster.org/pub/gluster/glusterfs/LATEST/Fedora/fedora-\\$releasever/noarch
      - el7:
          extra-repos: |
              ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
              ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
              glusterfs-epel-nightly,http://download.gluster.org/pub/gluster/glusterfs/nightly/glusterfs/epel-\\$releasever-\\$basearch
              glusterfs-epel,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-\\$releasever/\\$basearch
              glusterfs-noarch-epel,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-\\$releasever/noarch
      - el6:
          extra-repos: |
              ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
              ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
              glusterfs-epel-nightly,http://download.gluster.org/pub/gluster/glusterfs/nightly/glusterfs/epel-\\$releasever-\\$basearch
              glusterfs-epel,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-\\$releasever/\\$basearch
              glusterfs-noarch-epel,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-\\$releasever/noarch
    arch: x86_64
    jobs:
      - '{project}_{version}_install-rpm-sanity-{distro}_{trigger}':
          trigger-files: 'vdsm.spec.in'
          # Ugly fix until BZ#1111601 is solved
          extra-packages: 'm2crypto'
          extra-rpmbuild-options: 'with_check=0'
          packages: 'exported-artifacts/vdsm-*rpm'
          env: 'NOSE_EXCLUDE=.*'
