- project:
    name: vdsm_create-rpms
    project:
      - vdsm
    trigger:
      - merged
    version:
      - 3.5
    branch: ovirt-3.5
    mock-build-type: all
    distro:
      - fc19:
          extra-repos: |
            ovirt-3.5-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
            ovirt-3.5-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
            ci-tools,http://resources.ovirt.org/repos/ci-tools/$distro
          node-filter: 'fc19 || fc20 || el6 || el7'
      - fc20:
          extra-repos: |
            ovirt-3.5-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
            ovirt-3.5-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
            ci-tools,http://resources.ovirt.org/repos/ci-tools/$distro
      - el6:
          extra-repos: |
            ovirt-3.5-snapshot,http://resources.ovirt.org/pub/ovirt-3.5-snapshot/rpm/$distro
            ovirt-3.5-snapshot-static,http://resources.ovirt.org/pub/ovirt-3.5-snapshot-static/rpm/$distro
            ci-tools,http://resources.ovirt.org/repos/ci-tools/$distro
            gluster-epel6,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-6/\\$basearch
      - el7:
          extra-repos: |
            ovirt-3.5-snapshot,http://resources.ovirt.org/pub/ovirt-3.5-snapshot/rpm/$distro
            ovirt-3.5-snapshot-static,http://resources.ovirt.org/pub/ovirt-3.5-snapshot-static/rpm/$distro
            ci-tools,http://resources.ovirt.org/repos/ci-tools/$distro
            gluster-epel7,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-7/\\$basearch
    arch:
      - x86_64
      # PPC64 is not available yet
      # - ppc64
    extra-build-packages: |
      autoreconf
      gettext-devel
      make
      automake
      pyflakes
      python-pep8
      libvirt-python
      python-devel
      python-nose
      sanlock-python
      python-ordereddict
      python-pthreading
      libselinux-python
      python-ethtool
      m2crypto
      python-dmidecode
      python-netaddr
      python-inotify
      python-argparse
      git
      python-cpopen
      bridge-utils
      libguestfs-tools-c
      pyparted
      openssl
      libnl
      libtool
      gettext-devel
      python-ioprocess
    extra-packages: |
      pyflakes
      python-pep8
    extra-env: |
      NOSE_EXCLUDE=.*
    extra-rpmbuild-options: 'with_hooks=1'
    jobs:
      - '{project}_{version}_create-rpms-{distro}-{arch}_{trigger}'


- project:
    name: vdsm_master_create-rpms
    project:
      - vdsm
    trigger:
      - merged
    version:
      - master:
          branch: master
    mock-build-type: all
    arch:
      - x86_64
      # PPC64 is not available yet
      # - ppc64
    # Build usually require latest ioprocess rpms from testing repositories
    distro:
      - fc20:
          extra-repos: |
            ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
            ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
            updates-testing,http://download.fedoraproject.org/pub/fedora/linux/updates/testing/$releasever/\\$basearch
      - el6:
          extra-repos: |
            ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
            ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
            epel-testing,http://download.fedoraproject.org/pub/epel/testing/6/\\$basearch
            gluster-epel6,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-6/\\$basearch
      - el7:
          extra-repos: |
            ovirt-master-snapshot,http://resources.ovirt.org/pub/ovirt-master-snapshot/rpm/$distro
            ovirt-master-snapshot-static,http://resources.ovirt.org/pub/ovirt-master-snapshot-static/rpm/$distro
            epel-testing,http://download.fedoraproject.org/pub/epel/testing/7/\\$basearch
            gluster-epel7,http://download.gluster.org/pub/gluster/glusterfs/LATEST/EPEL.repo/epel-7/\\$basearch
    extra-build-packages: |
      autoreconf
      gettext-devel
      make
      automake
      pyflakes
      python-pep8
      libvirt-python
      python-devel
      python-nose
      sanlock-python
      python-ordereddict
      python-pthreading
      libselinux-python
      python-ethtool
      m2crypto
      python-dmidecode
      python-netaddr
      python-inotify
      python-argparse
      git
      python-cpopen
      bridge-utils
      libguestfs-tools-c
      pyparted
      openssl
      libnl
      libtool
      gettext-devel
      python-ioprocess
    extra-packages: |
      pyflakes
      python-pep8
    extra-env: |
      NOSE_EXCLUDE=.*
    jobs:
      - '{project}_{version}_create-rpms-{distro}-{arch}_{trigger}'
