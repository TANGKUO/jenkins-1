- job-template:
    name: 'repos_{version}_check-closure_{distro}_{trigger}'
    scm:
      - jenkins:
          branch: 'master'
          git-server: '{gerrit-server}'
    triggers:
        - timed: "H 6 * * *"
    parameters:
      - string:
          name: DISTRIBUTION
          default: '{distro}'
          description: the distribution to test
      - string:
          name: REPO_NAME
          default: 'ovirt-{version}-snapshot'
          description: 'Repos under http://resources.ovirt.org/pub'
      - string:
          name: STATIC_REPO
          default: 'ovirt-{version}-snapshot-static'
          description: 'Repos under http://resources.ovirt.org/pub'
      - bool:
          name: USE_STATIC
          default: true
      - string:
          name: EXPERIMENTAL_REPO
          default: '{version}'
          description: 'Repos under http://resources.ovirt.org/repos/ovirt/experimental'
      - bool:
          name: USE_EXPERIMENTAL
          default: false
      - bool:
          name: CLEAN_METADATA
          default: false
      - string:
          name: PATCHES
          description: comma-separated list of jenkins repo gerrit patches to apply
    builders:
      - shell: !include-raw: shell-scripts/global_setup.sh
      - shell: !include-raw: shell-scripts/mock_setup.sh
      - shell: !include-raw-escape: shell-scripts/repos-check-closure_apply-cherry-pick.sh
      - shell: !include-raw: shell-scripts/repos-check-closure_run-check.sh
    publishers:
      - mock-cleanup
      - exported-artifacts
      - groovy-postbuild:
          script: !include-raw-escape: groovy-scripts/repos-check-closure_post-build.groovy
          on-failure: 'nothing'
      - email-ext:
          recipients: infra@ovirt.org
          send-to:
            - recipients
            - requester
            - culprits
